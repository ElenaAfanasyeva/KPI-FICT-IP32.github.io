---
layout: post
title: "Лекція 13. Протоколи автентикації суб'єктів"
date: 2016-12-01 14:37:13 +0200
categories: kpi_s07_data_security
---


## 4.2 Протоколи автентикації суб'єктів на основі симетричних криптосистем

```
               +-----+    з    в    з    в
               | ЦРК |  K_а  K_а  K_б  K_б
               +-----+
                ^
     +---+      |               +---+
  з  | А |<-----+               | Б |    з
K_а  +---+<-------------------->+---+  K_б
```

1. $$ A \rightarrow C : I_{A_1}, I_{B_1}, r $$ де _r_ -- випадкове число;
2. $$ C \rightarrow A : Ш_{K^з_A}(I_{A_1}, K^з_S); Ш_{K^з_B}(I_{B_1}, K^з_S) $$;
3. $$ A \rightarrow B : Ш_{K^з_B}(I_{B_1}, K^з_S); Ш_{K^з_S}(r) $$;
4. $$ B \rightarrow A : Ш_{K^з_S}(f(r), e) $$;
5. $$ A \rightarrow B : Ш_{K^з_S}(f(e)) $$;

Даний протокол є подібним до протоколу рукостискання.

1. Якщо злочинець підробить сеансовий ключ, то він може змінити r, і видати себе за іншого. Втім, оскільки r задеклароване на сервері, цей ризик не такий вже й високий
2. MITM Attack. Злочинець може пропускати всі повідомлення через себе, дешифруючи або підміняючи їх. На це необхідний час $$ \Delta T \approx 2 год $$. Щоб запобігти даній вразливості, можна фіксувати часові мітки повідомлень.

## 4.3 Протоколи автентикації суб'єктів на основі асиметричних криптосистем

Використовується криптосистема RSA

```
          +-----+
          | ЦРК |
          +-----+
           ^
+---+      |               +---+
| А |<-----+               | Б |
+---+<-------------------->+---+
```

- У ЦРК є усі ключі, як відкриті, так і закриті
- У A і Б є всі відкриті ключі та свій закритий

В таких системах ключі повинні бути сертифіковані.

1. $$ A \rightarrow C: I_{A}, I_{B}, r $$;
2. $$ C \rightarrow A: Ш_{К^з_С}(I_A,K^в_A); Ш_{К^з_С}(I_B,K^в_B);$$ сертифікати
3. $$ A \rightarrow B: Ш_{К^з_С}(I_A,K^в_A); Ш_{K^в_А}(r) $$; На цьому стадія сертифікації завершена. Далі починається "рукостискання".
4. $$ B \rightarrow A: Ш_{К^в_B}(f(r), e) $$;
5. $$ A \rightarrow B: Ш_{К^в_А}(f(e)) $$;


## 4.4 Протокол автентикації повідомлень на основі симетричних криптосистем.

### Загальна схема.

Є якісь дані D
Суб'єкт-відправник формує цифровий підпис для даних: $$ W = ЦС(D) $$

$$ A \rightarrow B: D, W $$ -- дані надсилаються разом із цифровим підписом.

Розглянемо випадок, коли ініціатором є суб'єкт А:

1. $$ A \rightarrow C: Ш_{K^з_A}(I_A, I_B, D, W, e) $$ Суб'єкт А надсилає на ЦРК зашифровані своїм приватним ключем дані, цифровий підпис, тощо
2. $$ C \rightarrow B: Ш_{K^з_B}(I_A, I_B, D, W, e) $$;

Розглянемо випадок, коли ініціатором є суб'єкт B:

1. $$ A \rightarrow B: D, W $$ А передає B сертифікат і сигнатуру
2. $$ B \rightarrow C: Ш_{K^з_B}(I_A, I_B, D, W, e) $$;
3. $$ C \rightarrow A: Ш_{K^з_B}(I_A, I_B, D, W, e) $$;

тут e -- ознака перевірики цифрового підпису.

Протоколи автентикації повідомлень можуть бути реалізовані як із протоколами автентикації користувачів, так і без них.


