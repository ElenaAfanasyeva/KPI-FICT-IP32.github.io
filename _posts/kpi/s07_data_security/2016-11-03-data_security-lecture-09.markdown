---
layout: post
title: "Лекція 9. Особливості DES"
date: 2016-11-03 14:31:51 +0200
categories: kpi_s07_data_security
---

### Особливості шифрування по алгоритму DES


- Вихідне повідомлення розбивається на 2 блоки по 32 біти кожен і далі окремо оброблюються і ліва, і права частини, але при цьому на кожному циклі відбувається обмін між лівою і правою частинами,  ліва частина додається до функції шифрування за допомогою операції XOR.
- Функція шифрування є ключовим елементом алгоритму DES. Вона визначає такі важливі параметри, як криптостійкість і швидкість шифрування.

#### Функція шифрування DES

Розглянемо функцію шифрування.

![Feistel encryption function of DES](https://upload.wikimedia.org/wikipedia/commons/2/25/Data_Encription_Standard_Flow_Diagram.svg)

|12|17|31|1 |7 |8 |11|27|
|  |  |  |  |  |  |  |  |
|  |  |  |  |1 |  |  |  |
|  |  |  |  |7 |  |8 |  |

S-блоки -- блоки підстановки. Вони працюють за табличним принципом.

[0][1111][0] &rarr; [00][1111] &rarr; [0][15]

| 0101 | 1101 |
| 1101 | 0011 |
| ...  | ...  |
| ...  | ...  |

Таблиці S-блоків -- загальні для усіх S-блоків. Більш того, вони задаютлся стандартом алгоритму.

Розглянута функція -- т.з. "класична" функція шифрування за алгоритмом DES. Можливими модифікаціями є зміна довжини блоків шифрування і довжини циклових ключів. Зокрема, в деяких модифікаціях використовується цикловий ключ довжиною у 128 біт. Зміна тільки довжини циклового ключа без зміни довжини блоку призводить до зниження криптостійкості. Таким чином, треба змінювати і довжину блоку. Втім, збільшення довжини блоку шифрування призводить до зниження швидкодії алгоритму шифрування.


Наразі вимоги до довжини блоку шифрування значно знижені. Для сучасного рівня розвитку комп'ютерної техніки цілком приянйтними є довжини блоку шифрування до 1KB.

Також, підвищенню криптостійкості сприяє заміна E-блоку на P-блок. 

Важливим моментом є проблема формування циклового ключа. Існує спеціальна схема перетворень, за якою із базового ключа (довжиною 64 біти) ми отримуєм 16 циклових ключів (довжиною у 48 біт кожен).

#### Схема перетворення ключа з метою отримання циклових ключів

<!-- TODO: додати схему і пояснення з лекції -->

![Key generation scheme](https://upload.wikimedia.org/wikipedia/commons/0/07/DES_key_schedule.svg)

Існує певна послідовність, яка задає, на скільки бітів здійснювати циклічний зсув при генерації чергового циклового ключа. Як і таблиці перестановок, ця послідовність задається стандартом.

Схема алгоритму DES задана таким чином, що імовірність отримання двох однакових циклових ключів надзвичайно низька.

### Модифікації алгоритму DES

Найпершими модифікаціями алгоритму DES були 2DES і [3DES](https://en.wikipedia.org/wiki/Triple_DES)

Нехай D -- дані, K -- ключ, E -- зашифрований текст.
Тоді для алгоритму DES матимемо:

$$ E = Ш(D, K) $$

$$ D = РШ(E, K) $$

Криптостійкість схеми складає $$\approx 2^{70}$$

У алгоритмі 2DES є два ключа -- K1 і K2:

$$ E_1 = Ш(D, K_1) $$

$$ E = E_2 = РШ(E_1, K_2) $$

Для розшифрування:

$$ D_1 = Ш(E, K_2) $$

$$ D = D_2 = РШ(D_1, K_1) $$

Криптостійкість схеми складає $$\approx 2^{70}$$

Для схеми 3DES потрібно 3 ключі: $$K_1$$, $$K_2$$, $$K_3$$. Сама схема шифрування має вигляд:

$$ E_1 = Ш(D, K_1) $$

$$ E_2 = РШ(E_1, K_2) $$

$$ E = E_3 = Ш(E_2, K_3) $$

При розшифруванні схема 3DES має вигляд: 

$$ D_1 = РШ(E_3, K_3) $$

$$ D_2 = Ш(D_1, K_2) $$

$$ D = D_3 = РШ(D_2¸K_3) $$


Криптостійкість схеми 3DES досягає $$\approx 2^{90}$$
