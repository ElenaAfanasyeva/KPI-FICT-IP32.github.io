---
layout: post
title: "Лекція 8. Криптосистема «Люцифер», алгоритм DES"
date: 2016-10-27 14:31:32 +0300
categories: kpi_s07_data_security
---

## Люцифер

Детальніше: [wikipedia](https://en.wikipedia.org/wiki/Lucifer_(cipher))

На 1970 рік шифр Цезаря і Шенона вже були легко зламувані. Так. шифр Шенона можна було дешифрувати за ~1 добу.

Тому виникла потреба у новій криптосистемі. Такою криптосистемою стала система «Люцифер»

```
     +-------+  +-----+   +-------+  +-----+   +-------+  +-----+   +-------+
1 +--|   P   |  |  S  |   |   P   |  |  S  |   |   P   |  |  S  |   |   P   |
2 +--|       |--|     |---|       |--|     |---|       |--|     |---|       |
3 +--|       |  |     |   |       |  |     |   |       |  |     |   |       |
  +--|       |  +-----+   |       |  +-----+   |       |  +-----+   |       |
  +--|       |  +-----+   |       |  +-----+   |       |  +-----+   |       |
  +--|       |  |  S  |   |       |  |  S  |   |       |  |  S  |   |       |
  +--|       |--|     |---|       |--|     |---|       |--|     |---|       |
  +--|       |  |     |   |       |  |     |   |       |  |     |   |       |
  +--|       |  +-----+   |       |  +-----+   |       |  +-----+   |       |
  +--|       |  +-----+   |       |  +-----+   |       |  +-----+   |       |
  +--|       |  |  S  |   |       |  |  S  |   |       |  |  S  |   |       |
  +--|       |--|     |---|       |--|     |---|       |--|     |---|       |  64
  +--|       |  |     |   |       |  |     |   |       |  |     |   |       |--/--
  +--|       |  +-----+   |       |  +-----+   |       |  +-----+   |       |
  +--|       |            |       |            |       |            |       |
  +--|       |  ......    |       |  ......    |       |  ......    |       |
  +--|       |            |       |            |       |            |       |
  +--|       |            |       |            |       |            |       |
  +--|       |            |       |            |       |            |       |
  +--|       |            |       |            |       |            |       |
  +--|       |            |       |            |       |            |       |
  +--|       |            |       |            |       |            |       |
  +--|       |  +-----+   |       |  +-----+   |       |  +-----+   |       |
  +--|       |  |  S  |   |       |  |  S  |   |       |  |  S  |   |       |
  +--|       |--|     |---|       |--|     |---|       |--|     |---|       |
64+--|   1   |  |     |   |   2   |  |     |   |  15   |  |     |   |  16   |
     +-------+  +-----+   +-------+  +-----+   +-------+  +-----+   +-------+
```

- Схема використовує цикли шифрування. Цикл шифрування -- фрагмент схеми, що регулярно повторюється.
- Цикл шифрування може бути настроюваним, але загальна структура залишається постійною.
- У схемі «Люцифер» було вперше введено фіксований блок шифрування.
- Схема «Люцифер» -- симетрична. Дані подаються на вхід блоку P1, а на виході з блоку P16 отримуємо зашифрований текст. Щоб розшифрувати дані -- зашифрований текст подається на блок P16, а в блоці P1 -- отримаємо розшифрований текст.
- **Система «Люцифер» має одмин суттєвий недолік: в цій системі відсутнє курування** Тобто P-блоки задані у вигляді таблиць, S-блоки задані у вигляді таблиць. Ці таблиці не змінюються після первинного налаштування. Це означає, що всі дані шифруються по одній і тій же схемі.


Через деякий час була представлена модифікація криптосистеми, яка дозволяла управління.

```
     +-------+   +-----+              +-------+
1 +--|   P   |   |  S  |              |   P   |
2 +--|       |---|  1  |-            -|       |
3 +--|       | +-|     |              |       |
  +--|       | | +-----+              |       |
  +--|       | | +-----+              |       |
  +--|       | | |  S  |              |       |
  +--|       |---|     |-           --|       |
  +--|       | +-|     |              |       |
  +--|       | | +-----+              |       |
  +--|       | | +-----+              |       |
  +--|       | | |  S  |              |       |
  +--|       |---|     |-           --|       |  64
  +--|       | +-|     |              |       |--/--
  +--|       | | +-----+              |       |
  +--|       | |                      |       |
  +--|       | | ......     ......    |       |
  +--|       | |                      |       |
  +--|       | |                      |       |
  +--|       | |                      |       |
  +--|       | |                      |       |
  +--|       | |                      |       |
  +--|       | |                      |       |
  +--|       | | +-----+              |       |
  +--|       | | |  S  |              |       |
  +--|       |---|  8  |-           --|       |
64+--|   1   | +-|     |              |  16   |
     +-------+ | +-----+              +-------+
               |    
 D ------------+    
```

Другим недоліком є відсутність у схемі нелінійних а також математичних операцій.
Задля усунення цього недоліку було запропоноване використання додаткової функції шифрування, в тому числі і з нелінійними характеристиками.

Окрм того, для адаптації довжини блоків, що шифруються, до довжини ключа, було запропоновано використовувати т.з. E-блоки (Extended-blocks) -- блоки розширення.
Більш того, при формуванні внутрішніх ключів (в алгоритмі DES) було введено поняття V-блок -- блок вибірки.

## Криптоалгоритм DES

Детальніше: [wikipedia](https://en.wikipedia.org/wiki/Data_Encryption_Standard)

- Data Encryption Standard
- Розроблений у 1977 році
- Блочний алгоритм

Основні характеристики алгоритму DES:

1. Алгоритм симетричний (тобто для шифрування і розшифрування використовується один і той же ключ, який є секретним)
2. Алгоритм блочний, довжина блоку становить 64 біти. Це один із перших алгоритмів, де довжина блоку дорівнює довжині ключа $$k$$.
3. 16 циклів шифрування
4. Криптостійкість алгоритму оцінюється як $$2^{55} макрооперацій$$:

   Із 64 бітів ключа використовується всього лише 56 бітів. Тому загальна к-ть варіантів ключа -- $$2^{56}$$. Згідно теорії ймовірності, є імовірність підібрати ключ за менше, ніж $$2^{56}$$ спроб, тому криптостійкість дорівнює $$\frac{2^{56}}{2} = 2^{55}$$
5. Введено поняття "функція шифрування". Функція шифрування бере участь у кожному циклі шифрування, але при цьому вона є керованою. Керування здійснюється за допомогою ключа.
6. ...
7. Нелінійність процедури шифрування. За рахунок цього досягається поліноміальна складність відновлення ключа при відомих вхідних і вихідних даних.

### Схема

![Схема алгоритму DES](https://upload.wikimedia.org/wikipedia/commons/a/aa/Code.PNG)

Блоки `IP-1` і блок `FP-2` задаються таблично

| 17 | 2 | 52 | 37 | 8 | 15| 34 | 9 |
| 19 | 18 | … | … | … | … | … | … |
| 22 | … | … | … | … | … | … | … |
| … | … | … | … | … | … | … | … |
| … | … | … | … | … | … | … | … |
| … | … | … | … | … | … | … | … |
| … | … | … | … | … | … | … | … |
| … | … | … | … | … | … | … | … |

$$ 1 -> 17$$

$$ 2 -> 2 $$

$$ 3 -> 52$$

$$ 4 -> 37$$

$$ 5 -> 78$$ 

Матриці перестановок в DES (комерційній версії) є відкритими і задані стандартом.

Функція шифрування являє собою комбінацію S-блоків, E-блоків і P-блоків. При цьому всередині цієї функції використоується операція XOR із розрядами ключа.
Дана функція володіє властивістю нелінійності та є настроюваною, що дозволяє суттєво підвищити криптостійкість.
